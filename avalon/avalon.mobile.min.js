(function(n,S){"object"===typeof module&&"object"===typeof module.exports?module.exports=n.document?S(n,!0):function(n){if(!n.document)throw Error("Avalon requires a window with a document");return S(n)}:S(n)})("undefined"!==typeof window?window:this,function(n,S){function s(){avalon.config.debug&&console.log.apply(console,arguments)}function A(){return Object.create(null)}function x(){}function K(a,b){"string"===typeof a&&(a=a.match(u)||[]);for(var c={},d=void 0!==b?b:1,e=0,f=a.length;e<f;e++)c[a[e]]=
d;return c}function v(a){for(var b in a)if(Cb.call(a,b)){var c=a[b];if("function"===typeof v.plugins[b])v.plugins[b](c);else"object"===typeof v[b]?avalon.mix(v[b],c):v[b]=c}return this}function E(a,b,c){if(Array.isArray(a)){b=a.concat();a.length=0;var d=[];d.$id=F();d.$model=a;d.$events={};d.$events[B]=[];d._=E({length:a.length});d._.$watch("length",function(a,c){d.$fire("length",a,c)});for(var e in N)d[e]=N[e];avalon.mix(d,Ja);d.pushArray(b);return d}if(!a||0<a.nodeType||a.$id&&a.$events)return a;
Array.isArray(a.$skipArray)||(a.$skipArray=[]);a.$skipArray.$special=b||A();var f={},c=c||{},h=A(),g=A(),j=[],i;for(i in a)(function(b,d){c[b]=d;var e;e=a.$skipArray;if(L(d)||d&&d.nodeType||e.indexOf(b)!==-1||Ka.indexOf(b)!==-1)e=false;else{e=e.$special;e=b&&b.charAt(0)==="$"&&!e[b]?false:true}if(e){h[b]=[];e=avalon.type(d);var i=function(a){var c=i._name,b=this.$model,d=b[c],e=this.$events;if(arguments.length){if(!ka){if(i.type!==1){a:{var f=i,g=a;switch(f.type){case 0:var h=f.get,f=f.set;if(L(f)){var j=
this.$events,k=j[c];j[c]=[];f.call(this,g);j[c]=k}a=h.call(this);break a;case 1:a=g;break a;case 2:if(g!==this.$model[c]){h=this[c];if(f.valueType==="array"){if(Array.isArray(g)&&h!==g){h._.$unwatch();h.clear();h._.$watch();h.pushArray(g.concat())}g=h}else{var m=this.$events[c];if(j=h.$events.$withProxyPool){la(j,"with");h.$events.$withProxyPool=null}var p=E(g);p.$events[B]=m;ma[p.$id]=function(a){for(;a=m.shift();)(function(a){avalon.nextTick(function(){var c=a.type;if(c&&o[c]){a.rollback&&a.rollback();
o[c](a,a.vmodels)}})})(a);delete ma[p.$id]};g=p}f=f.svmodel=g;g=f.$model;(f=ma[f.$id])&&f()}a=g;break a}a=void 0}if(!i.type)return}if(!La(d,a)){b[c]=a;na(e[c]);this.$events&&N.$fire.call(this,c,a,d)}}}else{if(i.type===0){a=i.get.call(this);if(d!==a){b[c]=a;this.$events&&N.$fire.call(this,c,a,d)}return a}c=e[c];b=T[C];c&&(b&&avalon.Array.ensure(c,b)&&b.element)&&oa(b,c);return i.svmodel||d}};if(e==="object"&&L(d.get)&&Object.keys(d).length<=2){i.set=d.set;i.get=d.get;i.type=0;j.push(function(){var a=
{evaluator:function(){a.type=Math.random();a.element=null;c[b]=i.get.call(f)},element:pa,type:Math.random(),handler:x,args:[]};T[C]=a;i.call(f);delete T[C]})}else if(Ma.test(e)){i.type=2;i.valueType=e;j.push(function(){var a=E(d,0,c[b]);i.svmodel=a;a.$events[B]=h[b]})}else i.type=1;i._name=b;g[b]=i}})(i,a[i]);Ka.forEach(function(b){delete a[b];delete c[b]});var f=Object.defineProperties(f,Db(g),a),k;for(k in a)g[k]||(f[k]=a[k]);f.$id=F();f.$model=c;f.$events=h;for(i in N)f[i]=N[i];Object.defineProperty(f,
"hasOwnProperty",{value:function(a){return a in this.$model},writable:!1,enumerable:!1,configurable:!0});j.forEach(function(a){a()});return f}function P(a,b,c,d,e,f,h){for(var g=this.length,j=2;--j;){switch(a){case "add":var i=this.$model.slice(b,b+c).map(function(a){return Ma.test(avalon.type(a))?a.$id?a:E(a,0,a):a});qa.apply(this,[b,0].concat(i));this._fire("add",b,c);break;case "del":var k=this._splice(b,c);this._fire("del",b,c)}e&&(a=e,b=f,c=h,j=2,e=0)}this._fire("index",d);this.length!==g&&(this._.length=
this.length);return k}function ra(a,b){for(var c={},d=0,e=b.length;d<e;d++){c[d]=a[d];var f=b[d];f in c?(a[d]=c[f],delete c[f]):a[d]=a[f]}}function sa(a){T[C]=a;avalon.openComputedCollect=!0;var b=a.evaluator;if(b)try{var c=Eb.test(a.type)?a:b.apply(0,a.args);a.handler(c,a.element,a)}catch(d){delete a.evaluator,b=a.element,3===b.nodeType&&(c=b.parentNode,v.commentInterpolate?c.replaceChild(l.createComment(a.value),b):b.data=G+a.value+H)}avalon.openComputedCollect=!1;delete T[C]}function oa(a,b){a.$uuid=
a.$uuid||F();b.$uuid=b.$uuid||F();var c={data:a,list:b,$$uuid:a.$uuid+b.$uuid};I[c.$$uuid]||(I[c.$$uuid]=1,I.push(c))}function Na(a){a.element=null;a.rollback&&a.rollback();for(var b in a)a[b]=null}function Oa(){for(var a=I.length,b=a,c=0,d,e=[],f={},h={};d=I[--a];){var g=d.data;d=g.type;f[d]?f[d]++:(f[d]=1,e.push(d))}var j=!1;e.forEach(function(a){Pa[a]!==f[a]&&(h[a]=1,j=!0)});a=b;if(j)for(;d=I[--a];)if(g=d.data,void 0!==g.element){if(b=h[g.type])a:{e=g.element;try{if(!e.parentNode){b=!0;break a}}catch(i){b=
!0;break a}b=e.msRetain?0:1===e.nodeType?"number"===typeof e.sourceIndex?0===e.sourceIndex:!y.contains(e):!avalon.contains(y,e)}b&&(c++,I.splice(a,1),delete I[d.$$uuid],avalon.Array.remove(d.list,g),Na(g),d.data=d.list=null)}Pa=f;Qa=new Date}function na(a){if(a&&a.length){444<new Date-Qa&&"object"===typeof a[0]&&Oa();for(var b=ta.call(arguments,1),c=a.length,d;d=a[--c];){var e=d.element;e&&e.parentNode&&(d.$repeat?d.handler.apply(d,b):"on"!==d.type&&d.handler((d.evaluator||x).apply(0,d.args||[]),
e,d))}}}function ua(a,b,c){var d=setTimeout(function(){var e=a.innerHTML;clearTimeout(d);e===c?b():ua(a,b,e)})}function Ra(a,b){var c=a.getAttribute("avalonctrl")||b.$id;a.setAttribute("avalonctrl",c);b.$events.expr=a.tagName+'[avalonctrl="'+c+'"]'}function va(a,b){for(var c=0,d;d=a[c++];)d.vmodels=b,o[d.type](d,b),d.evaluator&&(d.element&&1===d.element.nodeType)&&d.element.removeAttribute(d.name);a.length=0}function Fb(a,b){return a.priority-b.priority}function Sa(a,b){for(var c=a.hasAttributes()?
avalon.slice(a.attributes):[],d=[],e=A(),f,h=0,g;g=c[h++];)if(g.specified&&(f=g.name.match(Gb))){var j=f[1],i=f[2]||"",k=g.value;g=g.name;e[g]=k;Hb[j]?(i=j,j="on"):Ib[j]&&(s("warning!\u8bf7\u6539\u7528ms-attr-"+j+"\u4ee3\u66ffms-"+j+"\uff01"),"enabled"===j&&(s("warning!ms-enabled\u6216ms-attr-enabled\u5df2\u7ecf\u88ab\u5e9f\u5f03"),j="disabled",k="!("+k+")"),i=j,j="attr",a.removeAttribute(g),g="ms-attr-"+i,a.setAttribute(g,k),f=[g],e[g]=k);if("function"===typeof o[j]){var m={type:j,param:i,element:a,
name:f[0],value:k,priority:j in Ta?Ta[j]:10*j.charCodeAt(0)+(Number(i)||0)};if("html"===j||"text"===j)i=wa(k),avalon.mix(m,i),m.filters=m.filters.replace(Ua,function(){m.type="html";m.group=1;return""});"ms-if-loop"===g&&(m.priority+=100);b.length&&(d.push(m),"widget"===j&&(a.msData=a.msData||e))}}if((h=a.type)&&e["ms-duplex"])e["ms-attr-checked"]&&/radio|checkbox/.test(h)&&s("warning!"+h+"\u63a7\u4ef6\u4e0d\u80fd\u540c\u65f6\u5b9a\u4e49ms-attr-checked\u4e0ems-duplex"),e["ms-attr-value"]&&/text|password/.test(h)&&
s("warning!"+h+"\u63a7\u4ef6\u4e0d\u80fd\u540c\u65f6\u5b9a\u4e49ms-attr-value\u4e0ems-duplex");d.sort(Fb);e=!0;for(h=0;m=d[h];h++){j=m.type;if(Jb.test(j))return va(d.slice(0,h+1),b);e&&(e=!Kb.test(j))}va(d,b);if(e&&!Lb[a.tagName]&&Va.test(a.innerHTML+a.textContent)){Wa&&Wa(a);for(d=a.firstChild;d;)e=d.nextSibling,Xa(d,d.nodeType,b),d=e}}function ca(a,b){for(var c=0,d;d=a[c++];)Xa(d,d.nodeType,b)}function Xa(a,b,c){1===b?(Ya(a,c),a.msCallback&&(a.msCallback(),a.msCallback=void 0)):3===b&&U.test(a.data)?
Za(a,c):v.commentInterpolate&&(8===b&&!U.test(a.nodeValue))&&Za(a,c)}function Ya(a,b,c){var c=a.getAttribute("ms-skip"),d=a.getAttributeNode("ms-important"),e=a.getAttributeNode("ms-controller");if("string"!==typeof c){if(c=d||e){e=avalon.vmodels[c.value];if(!e)return;b=c===d?[e]:[e].concat(b);a.removeAttribute(c.name);avalon(a).removeClass(c.name);Ra(a,e)}Sa(a,b)}}function wa(a){if(0<a.indexOf("|")){var b=a.replace(Mb,function(a){return Array(a.length+1).join("1")}).replace(Nb,"\u1122\u3344").indexOf("|");
if(-1<b)return{filters:a.slice(b),value:a.slice(0,b),expr:!0}}return{value:a,filters:"",expr:!0}}function xa(a){var b=[],c;c=0;var d;do{d=a.indexOf(G,c);if(-1===d)break;(c=a.slice(c,d))&&b.push({value:c,filters:"",expr:!1});c=d+G.length;d=a.indexOf(H,c);if(-1===d)break;(c=a.slice(c,d))&&b.push(wa(c));c=d+H.length}while(1);(c=a.slice(c))&&b.push({value:c,expr:!1,filters:""});return b}function Za(a,b){var c=[];if(8===a.nodeType)var d=wa(a.nodeValue),e=[d];else e=xa(a.data);if(e.length){for(var f=0;d=
e[f++];){var h=l.createTextNode(d.value);d.expr&&(d.type="text",d.element=h,d.filters=d.filters.replace(Ua,function(){d.type="html";d.group=1;return""}),c.push(d));Q.appendChild(h)}a.parentNode.replaceChild(Q,a);c.length&&va(c,b)}}function $a(a){return a.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function V(a){return 0>a.indexOf("-")&&0>a.indexOf("_")?a:a.replace(/[-_][^-_]/g,function(a){return a.charAt(1).toUpperCase()})}function ab(a){if(!("classList"in a)){a.classList={node:a};for(var b in bb)a.classList[b.slice(1)]=
bb[b]}return a.classList}function da(a){try{if("object"===typeof a)return a;a="true"===a?!0:"false"===a?!1:"null"===a?null:+a+""===a?+a:Ob.test(a)?JSON.parse(a):a}catch(b){}return a}function cb(a,b){if(0>=a.offsetWidth){var c=getComputedStyle(a,null);if(Pb.test(c.display)){var d={node:a},e;for(e in db)d[e]=c[e],a.style[e]=db[e];b.push(d)}(c=a.parentNode)&&1===c.nodeType&&cb(c,b)}}function Qb(a,b,c,d){for(var e=[],f=" = "+c+".",h=a.length,g;g=a[--h];)b.hasOwnProperty(g)&&(e.push(g+f+g),d.vars.push(g),
"duplex"===d.type&&(a.get=c+"."+g),a.splice(h,1));return e}function eb(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d],f=e&&"string"===typeof e.$id?e.$id:e;c[f]||(c[f]=b.push(e))}return b}function fb(a,b,c){var d=c.type,e=c.filters||"",f=b.map(function(a){return String(a.$id).replace(Rb,"$1")})+a+d+e,h;var g=a;h=","+g.trim();var j=gb.get(h);j?h=j:(g=g.replace(Sb,"").replace(Tb,",").replace(Ub,"").replace(Vb,"").replace(Wb,"").split(/^$|,+/),h=gb.put(h,eb(g)));var j=h.concat(),i=[];h=[];var k=
[],g="",b=eb(b);c.vars=[];for(var g=0,m=b.length;g<m;g++)if(j.length){var p="vm"+C+"_"+g;h.push(p);k.push(b[g]);i.push.apply(i,Qb(j,b[g],p,c))}if(i.length||"duplex"!==d)if("duplex"!==d&&(-1<a.indexOf("||")||-1<a.indexOf("&&"))&&c.vars.forEach(function(c){a=a.replace(RegExp("\\b"+c+"(?:\\.\\w+|\\[\\w+\\])+","ig"),function(b,d){var e=b.charAt(c.length),f=W?a.slice(d+b.length):RegExp.rightContext,f=/^\s*\(/.test(f);if(e==="."||e==="["||f){e="var"+String(Math.random()).replace(/^0\./,"");if(f){f=b.split(".");
if(f.length>2){var g=f.pop();i.push(e+" = "+f.join("."));return e+"."+g}return b}i.push(e+" = "+b);return e}return b})}),c.args=k,b=ya.get(f))c.evaluator=b;else{(g=i.join(", "))&&(g="var "+g);if(/\S/.test(e)){if(!/text|html/.test(c.type))throw Error("ms-"+c.type+"\u4e0d\u652f\u6301\u8fc7\u6ee4\u5668");d=a="\nvar ret"+C+" = "+a+";\r\n";j="ret"+C;e=e.replace(Xb,"").replace(Yb,function(){return"],|"}).replace(Zb,function(a,c){return"["+hb(c)}).replace($b,function(){return'"],["'}).replace(ac,function(){return'",'})+
"]";a=d+("return avalon.filters.$filter("+j+", "+e+")")}else{if("duplex"===d){e="'use strict';\nreturn function(vvv){\n\t"+g+";\n\tif(!arguments.length){\n\t\treturn "+a+"\n\t}\n\t"+(!bc.test(a)?j.get:a)+"= vvv;\n} ";try{b=Function.apply(x,h.concat(e)),c.evaluator=ya.put(f,b)}catch(l){s("debug: parse error,"+l.message)}return}"on"===d?(a=-1===a.indexOf("(")?a+".call(this, $event)":a.replace("(",".call(this,"),h.push("$event"),a="\nreturn "+a+";",d=a.lastIndexOf("\nreturn"),e=a.slice(0,d),d=a.slice(d),
a=e+"\n"+d):a="\nreturn "+a+";"}try{b=Function.apply(x,h.concat("'use strict';\n"+g+a)),c.evaluator=ya.put(f,b)}catch(n){s("debug: parse error,"+n.message)}finally{j=i=h=null}}}function D(a,b,c,d,e){Array.isArray(d)&&(a=d.map(function(a){return a.expr?"("+a.value+")":hb(a.value)}).join(" + "));fb(a,b,c);c.evaluator&&!e&&(c.handler=z[c.handlerName||c.type],sa(c))}function za(a){return null==a?"":a}function cc(a,b,c){b.param.replace(/\w+/g,function(d){(d=avalon.duplexHooks[d])&&"function"===typeof d[c]&&
(a=d[c](a,b))});return a}function dc(){for(var a=X.length-1;0<=a;a--)!1===(0,X[a])()&&X.splice(a,1);X.length||clearInterval(ib)}function jb(a,b,c,d){var e=a.template.cloneNode(!0),f=avalon.slice(e.childNodes);c.$stamp&&e.insertBefore(c.$stamp,e.firstChild);b.appendChild(e);a=[c].concat(a.vmodels);d.push({nodes:f,vmodels:a})}function kb(a,b){var c=a.proxies[b];return c?c.$stamp:a.element}function Aa(a,b,c){for(;;){var d=b.previousSibling;if(!d)break;d.parentNode.removeChild(d);c&&c.call(d);if(d===
a)break}}function ec(a,b){for(var c=b.param||"el",d,e=0,f=ea.length;e<f;e++){var h=ea[e];h&&h.hasOwnProperty(c)&&(d=h,ea.splice(e,1))}d||(e={$host:[],$outer:{},$stamp:1,$index:0,$first:!1,$last:!1,$remove:avalon.noop},e[c]={get:function(){var a=this.$events,b=a.$index;a.$index=a[c];try{return this.$host[this.$index]}finally{a.$index=b}},set:function(a){this.$host.set(this.$index,a)}},e=E(e,{$last:1,$first:1,$index:1}),e.$id=F("$proxy$each"),d=e);var g=b.$repeat,e=g.length-1;d.$index=a;d.$first=0===
a;d.$last=a===e;d.$host=g;d.$outer=b.$outer;d.$stamp=b.clone.cloneNode(!1);d.$remove=function(){return g.removeAt(d.$index)};return d}function fc(){var a=E({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(a){this.$host[this.$key]=a}}},{$val:1});a.$id=F("$proxy$with");return a}function la(a,b){var c="each"===b?ea:lb;avalon.each(a,function(a,b){if(b.$events){for(var f in b.$events)Array.isArray(b.$events[f])&&(b.$events[f].forEach(function(a){"object"===typeof a&&
Na(a)}),b.$events[f].length=0);b.$host=b.$outer={};c.unshift(b)>v.maxRepeatSize&&c.pop()}});"each"===b&&(a.length=0)}function Y(a,b){var c="_"+a;if(!Y[c]){var d=l.createElement(a);y.appendChild(d);b=Ba?getComputedStyle(d,null).display:d.currentStyle.display;y.removeChild(d);Y[c]=b}return Y[c]}function mb(a,b,c,d){var a=(a+"").replace(/[^0-9+\-Ee.]/g,""),a=!isFinite(+a)?0:+a,b=!isFinite(+b)?3:Math.abs(b),d=d||",",c=c||".",e="",e=function(a,c){var b=Math.pow(10,c);return""+(Math.round(a*b)/b).toFixed(c)},
e=(b?e(a,b):""+Math.round(a)).split(".");3<e[0].length&&(e[0]=e[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,d));if((e[1]||"").length<b)e[1]=e[1]||"",e[1]+=Array(b-e[1].length+1).join("0");return e.join(c)}var C=Date.now(),l=n.document,pa=l.head;pa.insertAdjacentHTML("afterBegin",'<avalon ms-skip class="avalonHide"><style id="avalonStyle">.avalonHide{ display: none!important }</style></avalon>');var fa=pa.firstChild,B="$"+C,gc=n.require,hc=n.define,ka=!1,u=/[^, ]+/g,Ma=/^(?:object|array)$/,Ca=/^\[object SVG\w*Element\]$/,
ic=/^\[object (?:Window|DOMWindow|global)\]$/,Da=Object.prototype,Cb=Da.hasOwnProperty,Z=Da.toString,J=Array.prototype,ta=J.slice,T={},Ba=n.dispatchEvent,y=l.documentElement,Q=l.createDocumentFragment(),ga=l.createElement("div"),nb={};"Boolean Number String Function Array Date RegExp Object Error".replace(u,function(a){nb["[object "+a+"]"]=a.toLowerCase()});var F=function(a){return((a||"avalon")+Math.random()+Math.random()).replace(/0\./g,"")},W;if(n.VBArray){var ob=document.documentMode;W=ob?ob:
n.XMLHttpRequest?7:6}else W=0;avalon=function(a){return new avalon.init(a)};avalon.nextTick=new function(){function a(){for(var a=e.length,c=0;c<a;c++)e[c]();e=e.slice(a)}var b=n.setImmediate,c=n.MutationObserver,d=Ba&&n.postMessage;if(b)return b.bind(n);var e=[];if(c){var f=document.createTextNode("avalon");(new c(a)).observe(f,{characterData:!0});return function(a){e.push(a);f.data=Math.random()}}return d?(n.addEventListener("message",function(c){var b=c.source;if((b===n||null===b)&&"process-tick"===
c.data)c.stopPropagation(),a()}),function(a){e.push(a);n.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}};avalon.init=function(a){this[0]=this.element=a};avalon.fn=avalon.prototype=avalon.init.prototype;avalon.type=function(a){return null==a?String(a):"object"===typeof a||"function"===typeof a?nb[Z.call(a)]||"object":typeof a};var L=function(a){return"[object Function]"===Z.call(a)};avalon.isFunction=L;avalon.isWindow=function(a){return ic.test(Z.call(a))};avalon.isPlainObject=function(a){return"[object Object]"===
Z.call(a)&&Object.getPrototypeOf(a)===Da};avalon.mix=avalon.fn.mix=function(){var a,b,c,d,e,f=arguments[0]||{},h=1,g=arguments.length,j=!1;"boolean"===typeof f&&(j=f,f=arguments[1]||{},h++);"object"!==typeof f&&!L(f)&&(f={});h===g&&(f=this,h--);for(;h<g;h++)if(null!=(a=arguments[h]))for(b in a)c=f[b],d=a[b],f!==d&&(j&&d&&(avalon.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,c=c&&Array.isArray(c)?c:[]):c=c&&avalon.isPlainObject(c)?c:{},f[b]=avalon.mix(j,c,d)):void 0!==d&&(f[b]=d));return f};avalon.mix({rword:u,
subscribers:B,version:1.43,ui:{},log:s,slice:function(a,b,c){return ta.call(a,b,c)},noop:x,error:function(a,b){throw new (b||Error)(a);},oneObject:K,range:function(a,b,c){c||(c=1);null==b&&(b=a||0,a=0);for(var d=-1,b=Math.max(0,Math.ceil((b-a)/c)),e=Array(b);++d<b;)e[d]=a,a+=c;return e},eventHooks:{},bind:function(a,b,c,d){var e=avalon.eventHooks[b];"object"===typeof e&&(b=e.type,e.deel&&(c=e.deel(a,b,c,d)));c.unbind||a.addEventListener(b,c,!!d);return c},unbind:function(a,b,c,d){var e=avalon.eventHooks[b],
f=c||x;"object"===typeof e&&(b=e.type,e.deel&&e.deel(a,b,c,!1));a.removeEventListener(b,f,!!d)},css:function(a,b,c){a instanceof avalon&&(a=a[0]);var d=/[_-]/.test(b)?V(b):b,b=avalon.cssName(d)||d;if(void 0===c||"boolean"===typeof c)return d=w[d+":get"]||w["@:get"],"background"===b&&(b="backgroundColor"),a=d(a,b),!0===c?parseFloat(a)||0:a;""===c?a.style[b]="":null==c||c!==c||(isFinite(c)&&!avalon.cssNumber[d]&&(c+="px"),d=w[d+":set"]||w["@:set"],d(a,b,c))},each:function(a,b){if(a){var c=0,d;a:{if(a&&
"object"===typeof a){d=a.length;var e=Z.call(a);if(/(Array|List|Collection|Map|Arguments)\]$/.test(e)){d=!0;break a}else if("[object Object]"===e&&d===d>>>0){d=!0;break a}}d=!1}if(d)for(d=a.length;c<d&&!1!==b(c,a[c]);c++);else for(c in a)if(a.hasOwnProperty(c)&&!1===b(c,a[c]))break}},getWidgetData:function(a,b){var c=avalon(a).data(),d={},e;for(e in c)0===e.indexOf(b)&&(d[e.replace(b,"").replace(/\w/,function(a){return a.toLowerCase()})]=c[e]);return d},Array:{ensure:function(a,b){if(-1===a.indexOf(b))return a.push(b)},
removeAt:function(a,b){return!!a.splice(b,1).length},remove:function(a,b){var c=a.indexOf(b);return~c?avalon.Array.removeAt(a,c):!1}}});var o=avalon.bindingHandlers={},z=avalon.bindingExecutors={},pb=new function(){function a(a){this.size=0;this.limit=a;this.head=this.tail=void 0;this._keymap={}}var b=a.prototype;b.put=function(a,b){var e={key:a,value:b};this._keymap[a]=e;this.tail?(this.tail.newer=e,e.older=this.tail):this.head=e;this.tail=e;this.size===this.limit?this.shift():this.size++;return b};
b.shift=function(){var a=this.head;a&&(this.head=this.head.newer,this.head.older=a.newer=a.older=this._keymap[a.key]=void 0)};b.get=function(a){a=this._keymap[a];if(void 0!==a){if(a===this.tail)return a.value;a.newer&&(a===this.head&&(this.head=a.newer),a.newer.older=a.older);a.older&&(a.older.newer=a.newer);a.newer=void 0;if(a.older=this.tail)this.tail.newer=a;this.tail=a;return a.value}};return a};l.contains||(Node.prototype.contains=function(a){return!!(this.compareDocumentPosition(a)&16)});avalon.contains=
function(a,b){try{for(;b=b.parentNode;)if(b===a)return true;return false}catch(c){return false}};if(n.SVGElement){var qb=l.createElementNS("http://www.w3.org/2000/svg","svg");qb.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />';if(!Ca.test(qb.firstChild)){var Ea=function(a,b){if(a&&a.childNodes)for(var c=a.childNodes,d=0,e;e=c[d++];)if(e.tagName){var f=l.createElementNS("http://www.w3.org/2000/svg",e.tagName.toLowerCase());J.forEach.call(e.attributes,function(a){f.setAttribute(a.name,a.value)});
Ea(e,f);b.appendChild(f)}};Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:function(){return(new XMLSerializer).serializeToString(this)},set:function(a){var b=this.tagName.toLowerCase(),c=this.parentNode,a=avalon.parseHTML(a);if(b==="svg")c.insertBefore(a,this);else{b=l.createDocumentFragment();Ea(a,b);c.insertBefore(b,this)}c.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var a=RegExp("</"+this.nodeName+">$","i");return this.outerHTML.replace(RegExp("<"+
this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),"").replace(a,"")},set:function(a){if(avalon.clearHTML){avalon.clearHTML(this);a=avalon.parseHTML(a);Ea(a,this)}}}})}}var ha=avalon.eventHooks;"onmouseenter"in y||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){ha[a]={type:b,deel:function(c,b,e){return function(b){var d=b.relatedTarget;if(!d||d!==c&&!(c.compareDocumentPosition(d)&16)){delete b.type;b.type=a;return e.call(c,b)}}}}});avalon.each({AnimationEvent:"animationend",
WebKitAnimationEvent:"webkitAnimationEnd"},function(a,b){if(n[a]&&!ha.animationend)ha.animationend={type:b}});void 0===l.onmousewheel&&(ha.mousewheel={type:"wheel",deel:function(a,b,c){return function(b){b.wheelDeltaY=b.wheelDelta=b.deltaY>0?-120:120;b.wheelDeltaX=0;Object.defineProperty(b,"type",{value:"mousewheel"});c.call(a,b)}}});var G,H,U,rb,Va,sb=/[-.*+?^${}()|[\]\/\\]/g;v.debug=!0;v.plugins={loader:function(){n.require=gc;n.define=hc},interpolate:function(a){G=a[0];H=a[1];if(G===H)throw new SyntaxError("openTag!==closeTag");
if(a+""==="<\!--,--\>")v.commentInterpolate=true;else{a=G+"test"+H;ga.innerHTML=a;if(ga.innerHTML!==a&&ga.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("\u6b64\u5b9a\u754c\u7b26\u4e0d\u5408\u6cd5");ga.innerHTML=""}var a=(G+"").replace(sb,"\\$&"),b=(H+"").replace(sb,"\\$&");U=RegExp(a+"(.*?)"+b);rb=RegExp(a+"(.*?)"+b,"g");Va=RegExp(a+".*?"+b+"|\\sms-")}};v.plugins.interpolate(["{{","}}"]);v.paths={};v.shim={};v.maxRepeatSize=100;avalon.config=v;var N={$watch:function(a,b){if(typeof b==="function"){var c=
this.$events[a];c?c.push(b):this.$events[a]=[b]}else this.$events=this.$watch.backup;return this},$unwatch:function(a,b){var c=arguments.length;if(c===0){this.$watch.backup=this.$events;this.$events={}}else if(c===1)this.$events[a]=[];else for(var c=this.$events[a]||[],d=c.length;~--d<0;)if(c[d]===b)return c.splice(d,1);return this},$fire:function(a){var b,c,d,e;if(/^(\w+)!(\S+)$/.test(a)){b=RegExp.$1;a=RegExp.$2}if(e=this.$events){var f=ta.call(arguments,1),h=[a].concat(f);if(b==="all")for(c in avalon.vmodels){d=
avalon.vmodels[c];d!==this&&d.$fire.apply(d,h)}else if(b==="up"||b==="down"){var g=e.expr?l.querySelectorAll(e.expr):[];if(g.length!==0){for(c in avalon.vmodels){d=avalon.vmodels[c];if(d!==this&&d.$events.expr){f=l.querySelectorAll(d.$events.expr);f.length!==0&&Array.prototype.forEach.call(f,function(a){Array.prototype.forEach.call(g,function(c){if(b==="down"?c.contains(a):a.contains(c))a._avalon=d})})}}c=l.getElementsByTagName("*");var j=[];Array.prototype.forEach.call(c,function(a){if(a._avalon){j.push(a._avalon);
a._avalon="";a.removeAttribute("_avalon")}});b==="up"&&j.reverse();for(c=0;e=j[c++];)if(e.$fire.apply(e,h)===false)break}}else{var h=e[a]||[],i=e.$all||[];for(c=0;e=h[c++];)L(e)&&e.apply(this,f);for(c=0;e=i[c++];)L(e)&&e.apply(this,arguments)}}}},tb=avalon.vmodels=A();avalon.define=function(a,b){var c=a.$id||a;c||s("warning: vm\u5fc5\u987b\u6307\u5b9a$id");tb[c]&&s("warning: "+c+" \u5df2\u7ecf\u5b58\u5728\u4e8eavalon.vmodels\u4e2d");if(typeof a==="object")var d=E(a);else{d={$watch:x};b(d);d=E(d);
ka=true;b(d);ka=false}d.$id=c;return tb[c]=d};var Ka="$id,$watch,$unwatch,$fire,$events,$model,$skipArray".match(u),ma=A(),La=Object.is||function(a,b){return a===0&&b===0?1/a===1/b:a!==a?b!==b:a===b},Db=function(a){var b=A(),c;for(c in a)b[c]={get:a[c],set:a[c],enumerable:true,configurable:true};return b},qa=J.splice,Ja={_splice:qa,_fire:function(a,b,c){na(this.$events[B],a,b,c)},size:function(){return this._.length},pushArray:function(a){var b=a.length,c=this.length;if(b){J.push.apply(this.$model,
a);P.call(this,"add",c,b,Math.max(0,c-1))}return b+c},push:function(){var a=[],b,c=arguments.length;for(b=0;b<c;b++)a[b]=arguments[b];return this.pushArray(a)},unshift:function(){var a=arguments.length,b=this.length;if(a){J.unshift.apply(this.$model,arguments);P.call(this,"add",0,a,0)}return a+b},shift:function(){if(this.length){var a=this.$model.shift();P.call(this,"del",0,1,0);return a}},pop:function(){var a=this.length;if(a){var b=this.$model.pop();P.call(this,"del",a-1,1,Math.max(0,a-2));return b}},
splice:function(a){var b=arguments.length,c=[],d,e=qa.apply(this.$model,arguments);if(e.length){c.push("del",a,e.length,0);d=true}if(b>2){d?c.splice(3,1,0,"add",a,b-2):c.push("add",a,b-2,0);d=true}return d?P.apply(this,c):[]},contains:function(a){return this.indexOf(a)!==-1},remove:function(a){return this.removeAt(this.indexOf(a))},removeAt:function(a){if(a>=0){this.$model.splice(a,1);return P.call(this,"del",a,1,0)}return[]},clear:function(){this.$model.length=this.length=this._.length=0;this._fire("clear",
0);return this},removeAll:function(a){if(Array.isArray(a))a.forEach(function(a){this.remove(a)},this);else if(typeof a==="function")for(var b=this.length-1;b>=0;b--)a(this[b],b)&&this.removeAt(b);else this.clear()},ensure:function(a){this.contains(a)||this.push(a);return this},set:function(a,b){if(a>=0){var c=avalon.type(b);if(b&&b.$model)b=b.$model;var d=this[a];if(c==="object")for(var e in b)d.hasOwnProperty(e)&&(d[e]=b[e]);else if(c==="array")d.clear().push.apply(d,b);else if(d!==b){this[a]=b;
this.$model[a]=b;this._fire("set",a,b)}}return this}};"sort,reverse".replace(u,function(a){Ja[a]=function(){var b=this.$model,c=b.concat(),d=Math.random(),e=[],f;J[a].apply(b,arguments);for(var h=0,g=c.length;h<g;h++){var j=b[h];if(La(j,c[h]))e.push(h);else{f=c.indexOf(j);e.push(f);c[f]=d;f=true}}if(f){ra(this,e);this._fire("move",e);this._fire("index",0)}return this}});var Eb=/^(duplex|on)$/,I=avalon.$$subscribers=[],Qa=new Date,Pa={},ia=new function(){avalon.mix(this,{option:l.createElement("select"),
thead:l.createElement("table"),td:l.createElement("tr"),area:l.createElement("map"),tr:l.createElement("tbody"),col:l.createElement("colgroup"),legend:l.createElement("fieldset"),_default:l.createElement("div"),g:l.createElementNS("http://www.w3.org/2000/svg","svg")});this.optgroup=this.option;this.tbody=this.tfoot=this.colgroup=this.caption=this.thead;this.th=this.td};"circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use".replace(u,function(a){ia[a]=ia.g});var jc=/<([\w:]+)/,
kc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,lc=K(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),mc=l.createElement("script"),nc=/<|&#?\w+;/;avalon.parseHTML=function(a){var b=Q.cloneNode(false);if(typeof a!=="string")return b;if(!nc.test(a)){b.appendChild(l.createTextNode(a));return b}var a=a.replace(kc,"<$1></$2>").trim(),c=(jc.exec(a)||["",""])[1].toLowerCase(),c=ia[c]||ia._default;c.innerHTML=a;a=c.getElementsByTagName("script");
if(a.length)for(var d=0,e;e=a[d++];)if(lc[e.type]){var f=mc.cloneNode(false);J.forEach.call(e.attributes,function(a){f.setAttribute(a.name,a.value)});f.text=e.text;e.parentNode.replaceChild(f,e)}for(;a=c.firstChild;)b.appendChild(a);return b};avalon.innerHTML=function(a,b){var c=this.parseHTML(b);this.clearHTML(a).appendChild(c)};avalon.clearHTML=function(a){for(a.textContent="";a.firstChild;)a.removeChild(a.firstChild);return a};avalon.scan=function(a,b){var a=a||y,c=b?[].concat(b):[];Ya(a,c)};var Lb=
K("AREA,BASE,BASEFONT,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,LINK,META,PARAM,SOURCE,TRACK,WBR,NOSCRIPT,SCRIPT,STYLE,TEXTAREA"),$=function(a,b,c){if(a=a.getAttribute(b))for(var b=0,d;d=c[b++];)if(d.hasOwnProperty(a)&&typeof d[a]==="function")return d[a]},Wa=W&&n.MutationObserver?function(a){for(var b=a.firstChild,c;b;){var d=b.nextSibling;if(b.nodeType===3)if(c){c.nodeValue=c.nodeValue+b.nodeValue;a.removeChild(b)}else c=b;else c=null;b=d}}:0,Gb=/ms-(\w+)-?(.*)/,Ta={"if":10,repeat:90,data:100,widget:110,
each:1400,"with":1500,duplex:2E3,on:3E3},Hb=K("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),Ib=K("value,title,alt,checked,selected,disabled,readonly,enabled"),Jb=/^if|widget|repeat$/,Kb=/^each|with|html|include$/,Ua=/\|\s*html\s*/,Nb=/\|\|/g,Mb=/(['"])(\\\1|.)+?\1/g,bb={_toString:function(){var a=this.node.className;return(typeof a==="string"?a:a.baseVal).split(/\s+/).join(" ")},
_contains:function(a){return(" "+this+" ").indexOf(" "+a+" ")>-1},_add:function(a){this.contains(a)||this._set(this+" "+a)},_remove:function(a){this._set((" "+this+" ").replace(" "+a+" "," "))},__set:function(a){var a=a.trim(),b=this.node;Ca.test(b)?b.setAttribute("class",a):b.className=a}};"add,remove".replace(u,function(a){avalon.fn[a+"Class"]=function(b){var c=this[0];b&&(typeof b==="string"&&c&&c.nodeType===1)&&b.replace(/\S+/g,function(b){ab(c)[a](b)});return this}});avalon.fn.mix({hasClass:function(a){var b=
this[0]||{};return b.nodeType===1&&ab(b).contains(a)},toggleClass:function(a,b){for(var c,d=0,e=String(a).split(/\s+/),f=typeof b==="boolean";c=e[d++];)this[(f?b:!this.hasClass(c))?"addClass":"removeClass"](c);return this},attr:function(a,b){if(arguments.length===2){this[0].setAttribute(a,b);return this}return this[0].getAttribute(a)},data:function(a,b){a="data-"+$a(a||"");switch(arguments.length){case 2:this.attr(a,b);return this;case 1:var c=this.attr(a);return da(c);case 0:var d={};J.forEach.call(this[0].attributes,
function(b){if(b){a=b.name;if(!a.indexOf("data-")){a=V(a.slice(5));d[a]=da(b.value)}}});return d}},removeData:function(a){a="data-"+$a(a);this[0].removeAttribute(a);return this},css:function(a,b){if(avalon.isPlainObject(a))for(var c in a)avalon.css(this,c,a[c]);else var d=avalon.css(this,a,b);return d!==void 0?d:this},position:function(){var a,b,c=this[0],d={top:0,left:0};if(c){if(this.css("position")==="fixed")b=c.getBoundingClientRect();else{a=this.offsetParent();b=this.offset();a[0].tagName!==
"HTML"&&(d=a.offset());d.top=d.top+avalon.css(a[0],"borderTopWidth",true);d.left=d.left+avalon.css(a[0],"borderLeftWidth",true);d.top=d.top-a.scrollTop();d.left=d.left-a.scrollLeft()}return{top:b.top-d.top-avalon.css(c,"marginTop",true),left:b.left-d.left-avalon.css(c,"marginLeft",true)}}},offsetParent:function(){for(var a=this[0].offsetParent;a&&avalon.css(a,"position")==="static";)a=a.offsetParent;return avalon(a||y)},bind:function(a,b,c){if(this[0])return avalon.bind(this[0],a,b,c)},unbind:function(a,
b,c){this[0]&&avalon.unbind(this[0],a,b,c);return this},val:function(a){var b=this[0];if(b&&b.nodeType===1){var c=arguments.length===0,d=c?":get":":set",e=oc,f;f=b.tagName.toLowerCase();f=f==="input"&&/checkbox|radio/.test(b.type)?"checked":f;if(d=e[f+d])var h=d(b,a);else{if(c)return(b.value||"").replace(/\r/g,"");b.value=a}}return c?h:this}});y.dataset&&(avalon.fn.data=function(a,b){var a=a&&V(a),c=this[0].dataset;switch(arguments.length){case 2:c[a]=b;return this;case 1:b=c[a];return da(b);case 0:var d=
A();for(a in c)d[a]=da(c[a]);return d}});var Ob=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/;avalon.parseJSON=JSON.parse;avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){avalon.fn[a]=function(c){var d=this[0]||{},e=d.window&&d.document?d:d.nodeType===9?d.defaultView:false,f=a==="scrollTop";if(arguments.length)e?e.scrollTo(!f?c:e[b],f?c:e[b]):d[a]=c;else return e?e[b]:d[a]}});var w=avalon.cssHooks=A(),ub=["","-webkit-","-moz-","-ms-"],Fa={"float":"cssFloat"};avalon.cssNumber=K("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom");
avalon.cssName=function(a,b,c){if(Fa[a])return Fa[a];for(var b=b||y.style,d=0,e=ub.length;d<e;d++){c=V(ub[d]+a);if(c in b)return Fa[a]=c}return null};w["@:set"]=function(a,b,c){a.style[b]=c};w["@:get"]=function(a,b){if(!a||!a.style)throw Error("getComputedStyle\u8981\u6c42\u4f20\u5165\u4e00\u4e2a\u8282\u70b9 "+a);var c,d=getComputedStyle(a);if(d){c=b==="filter"?d.getPropertyValue(b):d[b];c===""&&(c=a.style[b])}return c};w["opacity:get"]=function(a){a=w["@:get"](a,"opacity");return a===""?"1":a};"top,left".replace(u,
function(a){w[a+":get"]=function(b){var c=w["@:get"](b,a);return/px$/.test(c)?c:avalon(b).position()[a]+"px"}});var db={position:"absolute",visibility:"hidden",display:"block"},Pb=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(u,function(a){var b=a.toLowerCase(),c="client"+a,d="scroll"+a,e="offset"+a;w[b+":get"]=function(b,c,d){var j=-4;typeof d==="number"&&(j=d);c=a==="Width"?["Left","Right"]:["Top","Bottom"];d=b[e];if(j===2)return d+avalon.css(b,"margin"+c[0],true)+avalon.css(b,"margin"+c[1],
true);j<0&&(d=d-avalon.css(b,"border"+c[0]+"Width",true)-avalon.css(b,"border"+c[1]+"Width",true));j===-4&&(d=d-avalon.css(b,"padding"+c[0],true)-avalon.css(b,"padding"+c[1],true));return d};w[b+"&get"]=function(a){var c=[];cb(a,c);for(var d=w[b+":get"](a),e=0,i;i=c[e++];){var a=i.node,k;for(k in i)typeof i[k]==="string"&&(a.style[k]=i[k])}return d};avalon.fn[b]=function(f){var h=this[0];if(arguments.length===0){if(h.setTimeout)return h["inner"+a];if(h.nodeType===9){var g=h.documentElement;return Math.max(h.body[d],
g[d],h.body[e],g[e],g[c])}return w[b+"&get"](h)}return this.css(b,f)};avalon.fn["inner"+a]=function(){return w[b+":get"](this[0],void 0,-2)};avalon.fn["outer"+a]=function(a){return w[b+":get"](this[0],void 0,a===true?2:0)}});avalon.fn.offset=function(){var a=this[0];try{var b=a.getBoundingClientRect();if(b.width||b.height||a.getClientRects().length){var c=a.ownerDocument,d=c.documentElement,e=c.defaultView;return{top:b.top+e.pageYOffset-d.clientTop,left:b.left+e.pageXOffset-d.clientLeft}}}catch(f){return{left:0,
top:0}}};var oc={"select:get":function(a,b){for(var c,d=a.options,e=a.selectedIndex,f=a.type==="select-one"||e<0,h=f?null:[],g=f?e+1:d.length,j=e<0?g:f?e:0;j<g;j++){c=d[j];if((c.selected||j===e)&&!c.disabled){b=c.value;if(f)return b;h.push(b)}}return h},"select:set":function(a,b,c){for(var b=[].concat(b),d=0,e;e=a.options[d++];)if(e.selected=b.indexOf(e.value)>-1)c=true;if(!c)a.selectedIndex=-1}},hb=JSON.stringify,Sb=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,
Tb=/[^\w$]+/g,Ub=RegExp(""+("\\b"+"break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined".replace(/,/g,"\\b|\\b")+"\\b"),"g"),Vb=/\b\d[^,]*/g,
Wb=/^,+|,+$/g,gb=new pb(512),ya=new pb(128),bc=/\w\[.*\]|\w\.\w/,Rb=/(\$proxy\$[a-z]+)\d+$/,Xb=/\)\s*$/,Yb=/\)\s*\|/g,Zb=/\|\s*([$\w]+)/g,$b=/"\s*\["/g,ac=/"\s*\(/g;avalon.parseExprProxy=D;var vb={};"autofocus,autoplay,async,allowTransparency,checked,controls,declare,disabled,defer,defaultChecked,defaultSelected,contentEditable,isMap,loop,multiple,noHref,noResize,noShade,open,readOnly,selected".replace(u,function(a){vb[a.toLowerCase()]=a});var Ga={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff",
"class":"className","for":"htmlFor","http-equiv":"httpEquiv"};"accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan,dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign".replace(u,function(a){Ga[a.toLowerCase()]=a});var pc=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/img,qc=/<noscript.*?>([\s\S]+?)<\/noscript>/im,wb=function(){return new (n.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},M=avalon.templateCache=
{};o.attr=function(a,b){var c=a.value.trim(),d=true;if(c.indexOf(G)>-1&&c.indexOf(H)>2){d=false;if(U.test(c)&&RegExp.rightContext===""&&RegExp.leftContext===""){d=true;c=RegExp.$1}}if(a.type==="include"){var e=a.element;a.includeRendered=$(e,"data-include-rendered",b);a.includeLoaded=$(e,"data-include-loaded",b);var f=a.includeReplace=!!avalon(e).data("includeReplace");if(avalon(e).data("includeCache"))a.templateCache={};a.startInclude=l.createComment("ms-include");a.endInclude=l.createComment("ms-include-end");
if(f){a.element=a.startInclude;e.parentNode.insertBefore(a.startInclude,e);e.parentNode.insertBefore(a.endInclude,e.nextSibling)}else{e.insertBefore(a.startInclude,e.firstChild);e.appendChild(a.endInclude)}}a.handlerName="attr";D(c,b,a,d?0:xa(a.value))};z.attr=function(a,b,c){var d=c.type,e=c.param;if(d==="css")avalon(b).css(e,a);else if(d==="attr"){d=a===false||a===null||a===void 0;!Ba&&Ga[e]&&(e=Ga[e]);var f=vb[e];if(typeof b[f]==="boolean"){b[f]=!!a;a||(d=true)}if(d)return b.removeAttribute(e);
(Ca.test(b)?0:l.namespaces&&isVML(b)||e in b.cloneNode(false))?b[e]=a:b.setAttribute(e,a)}else if(d==="include"&&a){var h=c.vmodels,g=c.includeRendered,j=c.includeLoaded,i=c.includeReplace?b.parentNode:b,k=function(b){if(j){var d=j.apply(i,[b].concat(h));typeof d==="string"&&(b=d)}g&&ua(i,function(){g.call(i)},NaN);d=c.includeLastID;if(c.templateCache&&d&&d!==a){var e=c.templateCache[d];if(!e){e=c.templateCache[d]=l.createElement("div");fa.appendChild(e)}}for(c.includeLastID=a;;)if((d=c.startInclude.nextSibling)&&
d!==c.endInclude){i.removeChild(d);e&&e.appendChild(d)}else break;e=b;if(b=c.templateCache&&c.templateCache[a]){for(e=l.createDocumentFragment();d=b.firstChild;)e.appendChild(d);b=e}else b=avalon.parseHTML(e);e=avalon.slice(b.childNodes);i.insertBefore(b,c.endInclude);ca(e,h)};if(c.param==="src")if(typeof M[a]==="string")avalon.nextTick(function(){k(M[a])});else if(Array.isArray(M[a]))M[a].push(k);else{var m=wb();m.onreadystatechange=function(){if(m.readyState===4){var b=m.status;if(b>=200&&b<300||
b===304||b===1223){for(var b=m.responseText,c=0,d;d=M[a][c++];)d(b);M[a]=b}}};M[a]=[k];m.open("GET",a,true);if("withCredentials"in m)m.withCredentials=true;m.setRequestHeader("X-Requested-With","XMLHttpRequest");m.send(null)}else{var p=a&&a.nodeType===1?a:l.getElementById(a);if(p){if(p.tagName==="NOSCRIPT"&&!p.innerHTML&&!p.fixIE78){m=wb();m.open("GET",location,false);m.send(null);b=l.getElementsByTagName("noscript");e=(m.responseText||"").match(pc)||[];d=e.length;for(f=0;f<d;f++){var ja=b[f];if(ja){ja.style.display=
"none";ja.fixIE78=(e[f].match(qc)||["","&nbsp;"])[1]}}}avalon.nextTick(function(){k(p.fixIE78||p.value||p.innerText||p.innerHTML)})}}}else{if(!y.hasAttribute&&typeof a==="string"&&(d==="src"||d==="href"))a=a.replace(/&amp;/g,"&");b[d]=a;if(n.chrome&&b.tagName==="EMBED"){e=b.parentNode;d=document.createComment("ms-src");e.replaceChild(d,b);e.replaceChild(b,d)}}};"title,alt,src,value,css,include,href".replace(u,function(a){o[a]=o.attr});o["class"]=function(a,b){var c=a.param,d=a.value;a.handlerName=
"class";if(!c||isFinite(c)){a.param="";var e=d.replace(rb,function(a){return a.replace(/./g,"0")}).indexOf(":");if(e===-1)c=d;else{c=d.slice(0,e);d=d.slice(e+1);fb(d,b,a);if(a.evaluator){a._evaluator=a.evaluator;a._args=a.args}else{s("debug: ms-class '"+(d||"").trim()+"' \u4e0d\u5b58\u5728\u4e8eVM\u4e2d");return false}}d=U.test(c);if(!d)a.immobileClass=c;D("",b,a,d?xa(c):0)}else{a.immobileClass=a.oldStyle=a.param;D(d,b,a)}};z["class"]=function(a,b,c){var d=avalon(b),e=c.type;if(e==="class"&&c.oldStyle)d.toggleClass(c.oldStyle,
!!a);else{c.toggleClass=c._evaluator?!!c._evaluator.apply(b,c._args):true;c.newClass=c.immobileClass||a;c.oldClass&&c.newClass!==c.oldClass&&d.removeClass(c.oldClass);c.oldClass=c.newClass;switch(e){case "class":d.toggleClass(c.newClass,c.toggleClass);break;case "hover":case "active":if(!c.hasBindEvent){var f="mouseenter",h="mouseleave";if(e==="active"){b.tabIndex=b.tabIndex||-1;var f="mousedown",h="mouseup",g=d.bind("mouseleave",function(){c.toggleClass&&d.removeClass(c.newClass)})}var j=d.bind(f,
function(){c.toggleClass&&d.addClass(c.newClass)}),i=d.bind(h,function(){c.toggleClass&&d.removeClass(c.newClass)});c.rollback=function(){d.unbind("mouseleave",g);d.unbind(f,j);d.unbind(h,i)};c.hasBindEvent=true}}}};"hover,active".replace(u,function(a){o[a]=o["class"]});z.data=function(a,b,c){c="data-"+c.param;a&&typeof a==="object"?b[c]=a:b.setAttribute(c,String(a))};var R=o.duplex=function(a,b){var c=a.element,d;D(a.value,b,a,0,1);a.changed=$(c,"data-duplex-changed",b)||x;if(a.evaluator&&a.args){var e=
[],f=K("string,number,boolean,checked");if(c.type==="radio"&&a.param==="")a.param="checked";if(c.msData)c.msData["ms-duplex"]=a.value;a.param.replace(/\w+/g,function(b){if(/^(checkbox|radio)$/.test(c.type)&&/^(radio|checked)$/.test(b)){b==="radio"&&s("ms-duplex-radio\u5df2\u7ecf\u66f4\u540d\u4e3ams-duplex-checked");b="checked";a.isChecked=true}if(b==="bool"){b="boolean";s("ms-duplex-bool\u5df2\u7ecf\u66f4\u540d\u4e3ams-duplex-boolean")}else if(b==="text"){b="string";s("ms-duplex-text\u5df2\u7ecf\u66f4\u540d\u4e3ams-duplex-string")}f[b]&&
(d=true);avalon.Array.ensure(e,b)});d||e.push("string");a.param=e.join("-");a.bound=function(b,d){c.addEventListener?c.addEventListener(b,d,false):c.attachEvent("on"+b,d);var e=a.rollback;a.rollback=function(){c.avalonSetter=null;avalon.unbind(c,b,d);e&&e()}};for(var h in avalon.vmodels)avalon.vmodels[h].$fire("avalon-ms-duplex-init",a);(a.pipe||(a.pipe=cc))(null,a,"init");h=c.tagName;R[h]&&R[h](c,a.evaluator.apply(null,a.args),a)}};avalon.duplexHooks={checked:{get:function(a,b){return!b.element.oldValue}},
string:{get:function(a){return a},set:za},"boolean":{get:function(a){return a==="true"},set:za},number:{get:function(a,b){var c=parseFloat(a);if(-a===-c)return c;switch((/strong|medium|weak/.exec(b.element.getAttribute("data-duplex-number"))||["medium"])[0]){case "strong":return 0;case "medium":return a===""?"":0;case "weak":return a}},set:za}};var ib,X=[];avalon.tick=function(a){X.push(a)===1&&(ib=setInterval(dc,60))};var xb=x,yb=/text|password|hidden/;new function(){try{var a={},b=HTMLInputElement.prototype,
c=HTMLTextAreaElement.prototype,d=function(b){if(avalon.contains(y,this)){a[this.tagName].call(this,b);yb.test(this.type)&&!this.msFocus&&this.avalonSetter&&this.avalonSetter()}};Object.getOwnPropertyNames(HTMLInputElement.prototype);a.INPUT=Object.getOwnPropertyDescriptor(b,"value").set;Object.defineProperty(b,"value",{set:d});a.TEXTAREA=Object.getOwnPropertyDescriptor(c,"value").set;Object.defineProperty(c,"value",{set:d})}catch(e){xb=avalon.tick}};R.INPUT=function(a,b,c){function d(a){c.changed.call(this,
a,c)}function e(){i=true}function f(){i=false}var h=a.type,g=c.bound,j=avalon(a),i=false,k=function(){if(!i){var e=a.oldValue=a.value,e=c.pipe(e,c,"get");if(j.data("duplexObserve")!==false){b(e);d.call(a,e);j.data("duplex-focus")&&avalon.nextTick(function(){a.focus()})}}};c.handler=function(){var d=c.pipe(b(),c,"set")+"";if(d!==a.oldValue)a.value=d};if(c.isChecked||h==="radio"){k=function(){if(j.data("duplexObserve")!==false){var e=c.pipe(a.value,c,"get");b(e);d.call(a,e)}};c.handler=function(){var d=
b();a.checked=a.oldValue=c.isChecked?!!d:d+""===a.value};g("click",k)}else if(h==="checkbox"){k=function(){if(j.data("duplexObserve")!==false){var e=a.checked?"ensure":"remove",f=b();if(!Array.isArray(f)){s("ms-duplex\u5e94\u7528\u4e8echeckbox\u4e0a\u8981\u5bf9\u5e94\u4e00\u4e2a\u6570\u7ec4");f=[f]}avalon.Array[e](f,c.pipe(a.value,c,"get"));d.call(a,f)}};c.handler=function(){var d=[].concat(b());a.checked=d.indexOf(c.pipe(a.value,c,"get"))>-1};g("change",k)}else{var m=a.getAttribute("data-duplex-event")||
"input";a.attributes["data-event"]&&s("data-event\u6307\u4ee4\u5df2\u7ecf\u5e9f\u5f03\uff0c\u8bf7\u6539\u7528data-duplex-event");m.replace(u,function(a){switch(a){case "input":g("input",k);g("DOMAutoComplete",k);if(!W){g("compositionstart",e);g("compositionend",f)}break;default:g(a,k)}});g("focus",function(){a.msFocus=true});g("blur",function(){a.msFocus=false});yb.test(h)&&xb(function(){if(y.contains(a))!a.msFocus&&a.oldValue!==a.value&&k();else if(!a.msRetain)return false});a.avalonSetter=k}a.oldValue=
a.value;sa(c);d.call(a,a.value)};R.TEXTAREA=R.INPUT;R.SELECT=function(a,b,c){var d=avalon(a);c.handler=function(){var c=b(),c=c&&c.$model||c;Array.isArray(c)?a.multiple||s("ms-duplex\u5728<select multiple=true>\u4e0a\u8981\u6c42\u5bf9\u5e94\u4e00\u4e2a\u6570\u7ec4"):a.multiple&&s("ms-duplex\u5728<select multiple=false>\u4e0d\u80fd\u5bf9\u5e94\u4e00\u4e2a\u6570\u7ec4");c=Array.isArray(c)?c.map(String):c+"";if(c+""!==a.oldValue){d.val(c);a.oldValue=c+""}};c.bound("change",function(){if(d.data("duplexObserve")!==
false){var e=d.val(),e=Array.isArray(e)?e.map(function(a){return c.pipe(a,c,"get")}):c.pipe(e,c,"get");e+""!==a.oldValue&&b(e);c.changed.call(a,e,c)}});a.msCallback=function(){sa(c);c.changed.call(a,b(),c)}};z.html=function(a,b,c){var a=a==null?"":a,d="group"in c,e=d?b.parentNode:b;if(e){if(typeof a==="string")var f=avalon.parseHTML(a);else if(a.nodeType===11)f=a;else if(a.nodeType===1||a.item){a=a.nodeType===1?a.childNodes:a.item;for(f=Q.cloneNode(true);a[0];)f.appendChild(a[0])}f.firstChild||f.appendChild(l.createComment("ms-html"));
a=avalon.slice(f.childNodes);if(d){var d=c.group,h=1;c.group=a.length;for(c.element=a[0];h<d;){var g=b.nextSibling;if(g){e.removeChild(g);h++}}e.replaceChild(f,b)}else avalon.clearHTML(e).appendChild(f);ca(a,c.vmodels)}};o["if"]=o.data=o.text=o.html=function(a,b){D(a.value,b,a)};z["if"]=function(a,b,c){if(a){if(b.nodeType===8){b.parentNode.replaceChild(c.template,b);b=c.element=c.template}if(b.getAttribute(c.name)){b.removeAttribute(c.name);Sa(b,c.vmodels)}c.rollback=null}else if(b.nodeType===1){a=
c.element=l.createComment("ms-if");b.parentNode.replaceChild(a,b);c.template=b;fa.appendChild(b);c.rollback=function(){b.parentNode===fa&&fa.removeChild(b)}}};var zb=/\(([^)]*)\)/;o.on=function(a,b){var c=a.value;a.type="on";var d=a.param.replace(/-\d+$/,"");if(typeof o.on[d+"Hook"]==="function")o.on[d+"Hook"](a);if(c.indexOf("(")>0&&c.indexOf(")")>-1){d=(c.match(zb)||["",""])[1].trim();if(d===""||d==="$event")c=c.replace(zb,"")}D(c,b,a)};z.on=function(a,b,c){var a=function(a){return(c.evaluator||
x).apply(this,c.args.concat(a))},d=c.param.replace(/-\d+$/,"");if(d==="scan")a.call(b,{type:d});else if(typeof c.specialBind==="function")c.specialBind(b,a);else var e=avalon.bind(b,d,a);c.rollback=function(){typeof c.specialUnbind==="function"?c.specialUnbind():avalon.unbind(b,d,e)}};o.repeat=function(a,b){var c=a.type;D(a.value,b,a,0,1);a.proxies=[];var d=false;try{var e=a.$repeat=a.evaluator.apply(0,a.args||[]),f=avalon.type(e);if(f!=="object"&&f!=="array"){d=true;avalon.log("warning:"+a.value+
"\u53ea\u80fd\u662f\u5bf9\u8c61\u6216\u6570\u7ec4")}}catch(h){d=true}var g=a.value.split(".")||[];if(g.length>1){g.pop();for(var j=g[0],g=0,i;i=b[g++];)if(i&&i.hasOwnProperty(j)){g=i[j].$events||{};g[B]=g[B]||[];g[B].push(a);break}}g=a.element;g.removeAttribute(a.name);a.sortedCallback=$(g,"data-with-sorted",b);a.renderedCallback=$(g,"data-"+c+"-rendered",b);i=F(c);j=a.element=l.createComment(i+":end");a.clone=l.createComment(i);Q.appendChild(j);if(c==="each"||c==="with"){a.template=g.innerHTML.trim();
avalon.clearHTML(g).appendChild(j)}else{a.template=g.outerHTML.trim();g.parentNode.replaceChild(j,g)}a.template=avalon.parseHTML(a.template);a.rollback=function(){var b=a.element;if(b){z.repeat.call(a,"clear");var c=b.parentNode,d=a.template,e=d.firstChild;c.replaceChild(d,b);(b=a.$stamp)&&b.parentNode&&b.parentNode.removeChild(b);a.element=a.type==="repeat"?e:c}};if(!d){a.handler=z.repeat;a.$outer={};c="$key";d="$val";if(Array.isArray(e)){c="$first";d="$last"}for(g=0;i=b[g++];)if(i.hasOwnProperty(c)&&
i.hasOwnProperty(d)){a.$outer=i;break}c=e.$events;(d=(c||{})[B])&&avalon.Array.ensure(d,a)&&oa(a,d);if(f==="object"){a.$with=true;f=!c?{}:c.$withProxyPool||(c.$withProxyPool={});a.handler("append",e,f)}else e.length&&a.handler("add",0,e.length)}};z.repeat=function(a,b,c){if(a){var d=this.element,e=d.parentNode,f=this.proxies,h=Q.cloneNode(false);switch(a){case "add":for(var d=b+c,g=this.$repeat.length-1,g=[],j=kb(this,b),i=b;i<d;i++){var k=ec(i,this);f.splice(i,0,k);jb(this,h,k,g)}e.insertBefore(h,
j);for(i=0;h=g[i++];){ca(h.nodes,h.vmodels);h.nodes=h.vmodels=null}break;case "del":j=f[b].$stamp;d=kb(this,b+c);Aa(j,d);h=f.splice(b,c);la(h,"each");break;case "clear":if(h=this.$stamp||f[0]){j=h.$stamp||h;Aa(j,d)}la(f,"each");break;case "move":var j=f[0].$stamp,m=j.nodeValue,p=[],l=[];Aa(j,d,function(){l.unshift(this);if(this.nodeValue===m){p.unshift(l);l=[]}});ra(f,b);for(ra(p,b);l=p.shift();)for(;g=l.shift();)h.appendChild(g);e.insertBefore(h,d);break;case "index":for(g=f.length-1;c=f[b];b++){c.$index=
b;c.$first=b===0;c.$last=b===g}return;case "set":(k=f[b])&&na(k.$events[this.param||"el"]);return;case "append":f=c;j=[];g=[];for(k in b)b.hasOwnProperty(k)&&k!=="hasOwnProperty"&&j.push(k);if(this.sortedCallback)(i=this.sortedCallback.call(e,j))&&(Array.isArray(i)&&i.length)&&(j=i);for(i=0;k=j[i++];)if(k!=="hasOwnProperty"){if(!f[k]){var n=f,o=k,r=k,q=lb.pop();q||(q=fc());var O=this.$repeat;q.$key=r;q.$host=O;q.$outer=this.$outer;O.$events?q.$events.$val=O.$events[r]:q.$events={};n[o]=q}jb(this,
h,f[k],g)}i=this.$stamp=this.clone;e.insertBefore(i,d);e.insertBefore(h,d);for(i=0;h=g[i++];){ca(h.nodes,h.vmodels);h.nodes=h.vmodels=null}}a==="clear"&&(a="del");var aa=this.renderedCallback||x,ba=arguments;ua(e,function(){aa.apply(e,ba);e.oldValue&&e.tagName==="SELECT"&&avalon(e).val(e.oldValue.split(","))},NaN)}};"with,each".replace(u,function(a){o[a]=o.repeat});var ea=[],lb=[];z.text=function(a,b){a=a==null?"":a;if(b.nodeType===3)try{b.data=a}catch(c){}else b.textContent=a};avalon.parseDisplay=
Y;o.visible=function(a,b){var c=avalon(a.element),d=c.css("display");if(d==="none"){var e=c[0].style,f=/visibility/i.test(e.cssText),h=c.css("visibility");e.display="";e.visibility="hidden";d=c.css("display");d==="none"&&(d=Y(c[0].nodeName));e.visibility=f?h:""}a.display=d;D(a.value,b,a)};z.visible=function(a,b,c){b.style.display=a?c.display:"none"};o.widget=function(a,b){var c=a.value.match(u),d=a.element,e=c[0],f=c[1];if(!f||f==="$")f=F(e);var c=c[2]||e,h=avalon.ui[e];if(typeof h==="function"){for(var b=
d.vmodels||b,g=0,j;j=b[g++];)if(j.hasOwnProperty(c)&&typeof j[c]==="object"){var i=j[c],i=i.$model||i;break}if(i){g=i[e+"Id"];if(typeof g==="string"){s("warning!\u4e0d\u518d\u652f\u6301"+e+"Id");f=g}}g=avalon.getWidgetData(d,e);a.value=[e,f,c].join();a[e+"Id"]=f;a.evaluator=x;d.msData["ms-widget-id"]=f;var k=a[e+"Options"]=avalon.mix({},h.defaults,i||{},g);d.removeAttribute("ms-widget");var m=h(d,a,b)||{};if(m.$id){avalon.vmodels[f]=m;Ra(d,m);try{m.$init(function(){avalon.scan(d,[m].concat(b));typeof k.onInit===
"function"&&k.onInit.call(d,m,k,b)})}catch(p){}a.rollback=function(){try{m.widgetElement=null;m.$remove()}catch(a){}d.msData={};delete avalon.vmodels[m.$id]};oa(a,rc);n.chrome&&d.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(Oa)})}else avalon.scan(d,b)}else if(b.length)d.vmodels=b};var rc=[],sc=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,tc=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,uc=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/ig,vc={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/ig,
img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/ig,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/ig},wc=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,xc=/([^\#-~| |!])/g,Ha=avalon.filters={uppercase:function(a){return a.toUpperCase()},lowercase:function(a){return a.toLowerCase()},truncate:function(a,b,c){b=b||30;c=c===void 0?"...":c;return a.length>b?a.slice(0,b-c.length)+c:String(a)},$filter:function(a){for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b],e=avalon.filters[d.shift()];if(typeof e===
"function"){d=[a].concat(d);a=e.apply(null,d)}}return a},camelize:V,sanitize:function(a){return a.replace(sc,"").replace(uc,function(a){var c=a.toLowerCase().match(/<(\w+)\s/);if(c)(c=vc[c[1]])&&(a=a.replace(c,function(a,b,c){a=c.charAt(0);return b+"="+a+"javascript:void(0)"+a}));return a.replace(tc," ").replace(/\s+/g," ")})},escape:function(a){return String(a).replace(/&/g,"&amp;").replace(wc,function(a){var c=a.charCodeAt(0),a=a.charCodeAt(1);return"&#"+((c-55296)*1024+(a-56320)+65536)+";"}).replace(xc,
function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(a,b,c){return(b||"\uffe5")+mb(a,isFinite(c)?c:2)},number:mb};new function(){function a(a){return parseInt(a,10)||0}function b(a,b,c){var d="";if(a<0){d="-";a=-a}for(a=""+a;a.length<b;)a="0"+a;c&&(a=a.substr(a.length-b));return d+a}function c(a,c,d,e){return function(f){f=f["get"+a]();if(d>0||f>-d)f=f+d;f===0&&d===-12&&(f=12);return b(f,c,e)}}function d(a,b){return function(c,d){var e=c["get"+
a](),f=(b?"SHORT"+a:a).toUpperCase();return d[f][e]}}var e={yyyy:c("FullYear",4),yy:c("FullYear",2,0,true),y:c("FullYear",1),MMMM:d("Month"),MMM:d("Month",true),MM:c("Month",2,1),M:c("Month",1,1),dd:c("Date",2),d:c("Date",1),HH:c("Hours",2),H:c("Hours",1),hh:c("Hours",2,-12),h:c("Hours",1,-12),mm:c("Minutes",2),m:c("Minutes",1),ss:c("Seconds",2),s:c("Seconds",1),sss:c("Milliseconds",3),EEEE:d("Day"),EEE:d("Day",true),a:function(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]},Z:function(a){a=-1*
a.getTimezoneOffset();return a=(a>=0?"+":"")+(b(Math[a>0?"floor":"ceil"](a/60),2)+b(Math.abs(a%60),2))}},f=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,h=/^\/Date\((\d+)\)\/$/;Ha.date=function(b,c){var d=Ha.date.locate,g="",l=[],n,o,c=c||"mediumDate",c=d[c]||c;if(typeof b==="string")if(/^\d+$/.test(b))b=a(b);else if(h.test(b))b=+RegExp.$1;else{o=b.trim();var t=[0,0,0,0,0,0,0],r=new Date(0);o=o.replace(/^(\d+)\D(\d+)\D(\d+)/,function(b,c,d,e){b=e.length===4?[e,c,d]:
[c,d,e];t[0]=a(b[0]);t[1]=a(b[1])-1;t[2]=a(b[2]);return""});var q=r.setFullYear,O=r.setHours;o=o.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(b,c,d,e,f){t[3]=a(c);t[4]=a(d);t[5]=a(e);f&&(t[6]=Math.round(parseFloat("0."+f)*1E3));return""});var aa=0,ba=0;o=o.replace(/Z|([+-])(\d\d):?(\d\d)/,function(b,c,d,e){q=r.setUTCFullYear;O=r.setUTCHours;if(c){aa=a(c+d);ba=a(c+e)}return""});t[3]=t[3]-aa;t[4]=t[4]-ba;q.apply(r,t.slice(0,3));O.apply(r,t.slice(3));b=r}typeof b==="number"&&(b=new Date(b));if(avalon.type(b)===
"date"){for(;c;)if(o=f.exec(c)){l=l.concat(o.slice(1));c=l.pop()}else{l.push(c);c=null}l.forEach(function(a){n=e[a];g=g+(n?n(b,d):a.replace(/(^'|'$)/g,"").replace(/''/g,"'"))});return g}};var g={AMPMS:{"0":"\u4e0a\u5348",1:"\u4e0b\u5348"},DAY:{"0":"\u661f\u671f\u65e5",1:"\u661f\u671f\u4e00",2:"\u661f\u671f\u4e8c",3:"\u661f\u671f\u4e09",4:"\u661f\u671f\u56db",5:"\u661f\u671f\u4e94",6:"\u661f\u671f\u516d"},MONTH:{"0":"1\u6708",1:"2\u6708",2:"3\u6708",3:"4\u6708",4:"5\u6708",5:"6\u6708",6:"7\u6708",
7:"8\u6708",8:"9\u6708",9:"10\u6708",10:"11\u6708",11:"12\u6708"},SHORTDAY:{"0":"\u5468\u65e5",1:"\u5468\u4e00",2:"\u5468\u4e8c",3:"\u5468\u4e09",4:"\u5468\u56db",5:"\u5468\u4e94",6:"\u5468\u516d"},fullDate:"y\u5e74M\u6708d\u65e5EEEE",longDate:"y\u5e74M\u6708d\u65e5",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};g.SHORTMONTH=g.MONTH;Ha.date.locate=g};var Ab=[],Bb,Ia=function(a){for(Bb=true;a=Ab.shift();)a(avalon)};
"complete"===l.readyState?setTimeout(Ia):l.addEventListener("DOMContentLoaded",Ia);n.addEventListener("load",Ia);avalon.ready=function(a){Bb?a(avalon):Ab.push(a)};avalon.config({loader:!0});avalon.ready(function(){avalon.scan(l.body)});new function(){function a(a){return(a.pointerType==="touch"||a.pointerType===a.MSPOINTER_TYPE_TOUCH)&&a.isPrimary}function b(a,b){return a.type==="pointer"+b||a.type.toLowerCase()==="mspointer"+b}function c(a){var b=a.touches&&a.touches.length?a.touches:[a],a=a.changedTouches?
a.changedTouches[0]:b[0];return{x:a.clientX,y:a.clientY}}function d(a,b,c){var d=document.createEvent("Events");d.initEvent(b,true,true);d.fireByAvalon=true;if(c)d.detail=c;a.dispatchEvent(d)}function e(a){if(a.fireByAvalon)return true;if(i.element&&a.target.tagName.toLowerCase()!=="select"){a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=true;a.stopPropagation();a.preventDefault();if(a.type==="click")i.element=null}}var f=navigator.userAgent,h=f.indexOf("Android")>0,
g=/iP(ad|hone|od)/.test(f),j=o.on,i={},f=navigator.pointerEnabled,k=navigator.msPointerEnabled,l=g||false;try{var p=document.createElement("div");p.ontouchstart=function(){l=true};var s=document.createEvent("TouchEvent");s.initUIEvent("touchstart",true,true);p.dispatchEvent(s)}catch(u){}p=p.ontouchstart=null;p=["mousedown","mousemove","mouseup",""];l?p=["touchstart","touchmove","touchend","touchcancel"]:f?p=["pointerdown","pointermove","pointerup","pointercancel"]:k&&(p=["MSPointerDown","MSPointerMove",
"MSPointerUp","MSPointerCancel"]);var t,r;document.addEventListener("mousedown",e,true);document.addEventListener("click",e,true);document.addEventListener(p[0],function(e){var f=b(e,"down"),g=f?e:e.touches&&e.touches[0]||e,h="tagName"in g.target?g.target:g.target.parentNode,g=Date.now(),j=g-(i.last||g);avalon.mvCount=0;if(!f||a(e)){avalon.mix(i,c(e));i.mx=0;i.my=0;if(j>0&&j<=250)i.isDoubleTap=true;i.last=g;i.element=h;avalon(h).addClass(q.activeClass);r=setTimeout(function(){r=null;d(h,"hold");d(h,
"longtap");i={};avalon(h).removeClass(q.activeClass)},q.clickDuration);return true}});document.addEventListener(p[1],function(d){var e=b(d,"down"),f=c(d);avalon.mvCount==0&&(h&&Math.abs(i.x-f.x)>Math.abs(i.y-f.y))&&d.preventDefault();avalon.mvCount++;if(!e||a(d)){r&&clearTimeout(r);r=null;i.mx=i.mx+Math.abs(i.x-f.x);i.my=i.my+Math.abs(i.y-f.y)}});document.addEventListener(p[2],function(e){var f=b(e,"down");element=i.element;if((!f||a(e))&&element){r&&clearTimeout(r);r=null;var f=c(e),g=Math.abs(i.x-
f.x),h=Math.abs(i.y-f.y);if(g>30||h>30){var e=Math.abs(i.x-f.x)>=Math.abs(i.y-f.y)?i.x-f.x>0?"left":"right":i.y-f.y>0?"up":"down",j={direction:e};d(element,"swipe",j);d(element,"swipe"+e,j);avalon(element).removeClass(q.activeClass);i={};i.element=element}else if(q.canClick(element)&&i.mx<q.dragDistance&&i.my<q.dragDistance){document.activeElement&&document.activeElement!==element&&document.activeElement.blur();element.tagName.toLowerCase()==="label"&&(j=element.htmlFor?document.getElementById(element.htmlFor):
null);j?q.focus(j):q.focus(element);e.target.tagName.toLowerCase()!=="select"&&e.preventDefault();d(element,"tap");avalon.fastclick.fireEvent(element,"click",e);avalon(element).removeClass(q.activeClass);if(i.isDoubleTap){d(element,"doubletap");avalon.fastclick.fireEvent(element,"dblclick",e);i={};avalon(element).removeClass(q.activeClass);i.element=element}else t=setTimeout(function(){clearTimeout(t);t=null;i={};avalon(element).removeClass(q.activeClass);i.element=element},250)}}});p[3]&&document.addEventListener(p[3],
function(){r&&clearTimeout(r);t&&clearTimeout(t);r=t=null;i={}});var q=avalon.fastclick={activeClass:"ms-click-active",clickDuration:750,dragDistance:30,fireEvent:function(a,b,c){var d=document.createEvent("MouseEvents");d.initMouseEvent(b,true,true,n,1,c.screenX,c.screenY,c.clientX,c.clientY,false,false,false,false,0,null);Object.defineProperty(d,"fireByAvalon",{value:true});a.dispatchEvent(d)},focus:function(a){if(this.canFocus(a)){var b=a.value;a.value=b;if(g&&a.setSelectionRange&&a.type.indexOf("date")!==
0&&a.type!=="time"){b=b.length;a.setSelectionRange(b,b)}else a.focus()}},canClick:function(a){switch(a.nodeName.toLowerCase()){case "textarea":case "select":case "input":return!a.disabled;default:return true}},canFocus:function(a){switch(a.nodeName.toLowerCase()){case "textarea":return true;case "select":return!h;case "input":switch(a.type){case "button":case "checkbox":case "file":case "image":case "radio":case "submit":return false}return!a.disabled&&!a.readOnly;default:return false}}};["swipe",
"swipeleft","swiperight","swipeup","swipedown","doubletap","tap","dblclick","longtap","hold"].forEach(function(a){j[a+"Hook"]=j.clickHook})};"function"===typeof define&&define.amd&&define("avalon",[],function(){return avalon});var yc=n.avalon;avalon.noConflict=function(a){if(a&&n.avalon===avalon)n.avalon=yc;return avalon};void 0===S&&(n.avalon=avalon);return avalon});
